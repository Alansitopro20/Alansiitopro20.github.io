<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Multi Target Cards</title>
    <script src="https://cdn.jsdelivr.net/npm/aframe@1.5.0/dist/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar/dist/aframe/mindar-image-aframe.prod.js"></script>
    <style>
      body { margin: 0; overflow: hidden; }
      .card {
        position: absolute;
        top: 20%;
        left: 50%;
        transform: translateX(-50%);
        width: 300px;
        height: 200px;
        border-radius: 15px;
        box-shadow: 0px 4px 10px rgba(0,0,0,0.3);
        display: none;
        justify-content: center;
        align-items: center;
        font-size: 24px;
        font-weight: bold;
        color: white;
      }
      .controls {
        position: absolute;
        bottom: 10%;
        width: 100%;
        text-align: center;
        display: none;
      }
      .btn {
        background: #333;
        color: white;
        padding: 10px 20px;
        margin: 0 10px;
        border-radius: 10px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <!-- Cards grupo 1 (target1) -->
    <div id="cards1">
      <div class="card" style="background: crimson;" id="card1">Card 1</div>
      <div class="card" style="background: darkorange;" id="card2">Card 2</div>
      <div class="card" style="background: goldenrod;" id="card3">Card 3</div>
      <div class="card" style="background: seagreen;" id="card4">Card 4</div>
      <div class="card" style="background: steelblue;" id="card5">Card 5</div>
      <div class="card" style="background: slateblue;" id="card6">Card 6</div>
      <div class="card" style="background: indigo;" id="card7">Card 7</div>
      <div class="card" style="background: violet;" id="card8">Card 8</div>
      <div class="card" style="background: teal;" id="card9">Card 9</div>
      <div class="card" style="background: brown;" id="card10">Card 10</div>
    </div>

    <!-- Cards grupo 2 (target2) -->
    <div id="cards2">
      <div class="card" style="background: navy;" id="card11">Card 11</div>
      <div class="card" style="background: purple;" id="card12">Card 12</div>
      <div class="card" style="background: olive;" id="card13">Card 13</div>
      <div class="card" style="background: tomato;" id="card14">Card 14</div>
      <div class="card" style="background: peru;" id="card15">Card 15</div>
      <div class="card" style="background: darkcyan;" id="card16">Card 16</div>
      <div class="card" style="background: firebrick;" id="card17">Card 17</div>
    </div>

    <!-- Controles -->
    <div class="controls" id="controls">
      <span class="btn" id="prevBtn">⬅️</span>
      <span class="btn" id="nextBtn">➡️</span>
    </div>

    <!-- Escena A-Frame con MindAR -->
    <a-scene mindar-image="imageTargetSrc: ./assets/targets.mind; autoStart: true;" embedded color-space="sRGB" renderer="precision: mediump;">

      <!-- Target1 -->
      <a-entity mindar-image-target="targetIndex: 0" id="target1"></a-entity>

      <!-- Target2 -->
      <a-entity mindar-image-target="targetIndex: 1" id="target2"></a-entity>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
    </a-scene>

    <script>
      const cards1 = [...document.querySelectorAll("#cards1 .card")];
      const cards2 = [...document.querySelectorAll("#cards2 .card")];
      const controls = document.getElementById("controls");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");

      let activeGroup = null;
      let activeCards = [];
      let currentIndex = 0;

      function showCard(index) {
        activeCards.forEach((c, i) => c.style.display = (i === index ? "flex" : "none"));
      }

      prevBtn.onclick = () => {
        currentIndex = (currentIndex - 1 + activeCards.length) % activeCards.length;
        showCard(currentIndex);
      };

      nextBtn.onclick = () => {
        currentIndex = (currentIndex + 1) % activeCards.length;
        showCard(currentIndex);
      };

      function activateGroup(groupCards) {
        // Ocultar todos los grupos
        [...cards1, ...cards2].forEach(c => c.style.display = "none");

        activeGroup = groupCards;
        activeCards = groupCards;
        currentIndex = 0;
        showCard(currentIndex);
        controls.style.display = "block";
      }

      function deactivateGroup() {
        if (activeGroup) {
          activeGroup.forEach(c => c.style.display = "none");
        }
        controls.style.display = "none";
        activeGroup = null;
      }

      // Eventos de MindAR
      const target1 = document.querySelector("#target1");
      const target2 = document.querySelector("#target2");

      target1.addEventListener("targetFound", () => {
        activateGroup(cards1);
      });
      target1.addEventListener("targetLost", () => {
        deactivateGroup();
      });

      target2.addEventListener("targetFound", () => {
        activateGroup(cards2);
      });
      target2.addEventListener("targetLost", () => {
        deactivateGroup();
      });
    </script>
  </body>
</html>
